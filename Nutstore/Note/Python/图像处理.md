```python
# %%	#进入jupyter模式
```

# skimage



skimage即是Scikit-Image。基于python脚本语言开发的数字图片处理包，比如PIL,Pillow, opencv, scikit-image等。

 skimage包的全称是scikit-image SciKit (toolkit for SciPy) ，它对scipy.ndimage进行了扩展，提供了更多的图片处理功能。它是由python语言编写的，由scipy 社区开发和维护。skimage包由许多的子模块组成，各个子模块提供不同的功能。主要子模块列表如下：

| 子模块名称   | 主要实现功能                                                |
| ------------ | ----------------------------------------------------------- |
| io           | 读取、保存和显示图片或视频                                  |
| data         | 提供一些测试图片和样本数据                                  |
| color        | 颜色空间变换                                                |
| filters      | 图像增强、边缘检测、排序滤波器、自动阈值等                  |
| draw         | 操作于numpy数组上的基本图形绘制，包括线条、矩形、圆和文本等 |
| transform    | 几何变换或其它变换，如旋转、拉伸和拉东变换等                |
| morphology   | 形态学操作，如开闭运算、骨架提取等                          |
| exposure     | 图片强度调整，如亮度调整、直方图均衡等                      |
| feature      | 特征检测与提取等                                            |
| measure      | 图像属性的测量，如相似性或等高线等                          |
| segmentation | 图像分割                                                    |
| restoration  | 图像恢复                                                    |
| util         | 通用函数                                                    |

1.显示一张图片

```python
from skimage import io				#io模块：图片输入输出操作。
img = io.imread('../image/1.jpg')	#imread 读取制定路径的图片
io.imshow(img)						#将图片显示出来
```

```python
img = io.imread('../image/1.jpg',as_gray=True) #as_gray参数：是否显示灰度图片
```

skimage程序自带了一些示例图片，如果我们不想从外部读取图片，就可以直接使用这些示例图片：

```python
img = data.binary_blobs()
```

打印自带图片的路径

```python
from skimage import data_dir	#data_dir存放的是data_dir地址
print(data_dir)
#可以通过另一种方法读取datal里的图片
img = io.imread(data_dir+'/binary_blobs.png')
```

打印图像信息

```python
img=data.chelsea()
io.imshow(img)
print(type(img))  #显示类型
print(img.shape)  #显示尺寸
print(img.shape[0])  #图片宽度
print(img.shape[1])  #图片高度
print(img.shape[2])  #图片通道数
print(img.size)   #显示总像素个数
print(img.max())  #最大像素值
print(img.min())  #最小像素值
print(img.mean()) #像素平均值
```

图片读入程序中后，是以numpy数组存在的。因此对numpy数组的一切功能，对图片也适用。对数组元素的访问，实际上就是对图片像素点的访问。

彩色图片访问方式为：

```python
img[i,j,c]
```

i表示图片的行数，j表示图片的列数，c表示图片的通道数（RGB三通道分别对应0，1，2）。坐标是从左上角开始。

灰度图片访问方式为：

```python
gray[i,j]
```

输出小猫图片的G（green）通道中的第20行30列的像素值

```python
pixel=img[20,30,1]
print(pixel)
```

显示红色单通道图片

```python
R=img[:,:,0]
io.imshow(R)
```

对小猫图片随机添加椒盐噪声

```python
import numpy as np
rows,cols,dims=img.shape
for i in range(5000):
    x=np.random.randint(0,rows)
    y=np.random.randint(0,cols)
    img[x,y,:]=255
io.imshow(img)	#将原来的三通道像素值都变为255
```

对图片进行裁剪

```python
roi = img[80:180,100:200,:]
io.imshow(roi)
```

对多个像素点进行操作，使用数组切片方式访问

```python
img[i,:] = im[j,:] # 将第 j 行的数值赋值给第 i 行
img[:,i] = 100 # 将第 i 列的所有数值设为 100
img[:100,:50].sum() # 计算前 100 行、前 50 列所有数值的和
img[50:100,50:100] # 50~100 行，50~100 列（不包括第 100 行和第 100 列）
img[i].mean() # 第 i 行所有数值的平均值
img[:,-1] # 最后一列
img[-2,:] #(or im[-2]) # 倒数第二行
```

将图片进行二值化，像素128的变为1，否则变为0

```python
from skimage import color
img = data.chelsea()
img_gray = color.rgb2gray(img)
rows,cols = img_gray.shape
for i in range(rows):
    for j in range(cols):
        if(img_gray[i,j]<=0.5):
            img_gray[i,j]=0
        else:
            img_gray[i,j]=1
io.imshow(img_gray)
```

先对R通道的所有像素进行判断，如果大于170，则这个地方的像素值变为[0,255,0]，即G通道值为255，R和B通道值为0

```python
img=data.chelsea()

reddish = img[:, :, 0] >170

img[reddish] = [0, 255, 0]

io.imshow(img)
```

------

2020.12.04

在skimage中，一张图片就是一个简单的numpy数组，数组的数据类型有很多种，相互之间也可以转换。这些数据类型及取值范围如下表所示：

| Data type | Range             |
| --------- | ----------------- |
| uint8     | 0 to 255          |
| uint16    | 0 to 65535        |
| uint32    | 0 to 232          |
| float     | -1 to 1 or 0 to 1 |
| int8      | -128 to 127       |
| int16     | -32768 to 32767   |
| int32     | -231 to 231 - 1   |

一张图片的像素值范围是[0,255]，默认类型unit8，可使用如下代码查看数据类型

```python
img = data.chelsea()
print(img.data.name)
```

uint8转float

```python
from skimage import img_as_float
dst = img_as_float(img)
```

float转uint8

```python
from skimage import img_as_ubyte
img = np.array([0,0.5,1],dtype = float)
dst = img_as_ubyte(img)
print(dst.dtype.name)
```

float转uint8，可能会造成数据损失，会有警告提醒。

除了这两种最常用的转换以外，其实有一些其它的类型转换，如下表：

| Function name | Description                       |
| ------------- | --------------------------------- |
| img_as_float  | Convert to 64-bit floating point. |
| img_as_ubyte  | Convert to 8-bit uint.            |
| img_as_uint   | Convert to 16-bit uint.           |
| img_as_int    | Convert to 16-bit int.            |

------

